<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Pair Stats</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
    const { useState, useEffect } = React;

    function App() {
        const defaultTeams = ['Barcelona', 'Real Madrid', 'Manchester United', 'Liverpool', 'Bayern Munich', 'PSG', 'Chelsea', 'Arsenal', 'Manchester City', 'Juventus', 'AC Milan', 'Inter Milan'];
        const [teams, setTeams] = useState(defaultTeams);
        const [bets, setBets] = useState([]);
        const [showAddForm, setShowAddForm] = useState(false);
        const [showEditTeams, setShowEditTeams] = useState(false);
        const [searchTerm, setSearchTerm] = useState('');
        const [selectedPair, setSelectedPair] = useState('');
        const [newTeamName, setNewTeamName] = useState('');
        const [showAllBets, setShowAllBets] = useState(false);
        const [currentPage, setCurrentPage] = useState(1);
        const [editingBet, setEditingBet] = useState(null);
        const betsPerPage = 20;
        const [formData, setFormData] = useState({
            teamA: '', teamB: '', goalLine: '2.75', timeFrame: 'fulltime', bettingScore: '',
            odds: '', result: '', actualGoals: '', actualScore: '', date: new Date().toISOString().split('T')[0]
        });

        useEffect(() => {
            const savedTeams = localStorage.getItem('bettingTeams');
            const savedBets = localStorage.getItem('bettingBets');
            if (savedTeams) setTeams(JSON.parse(savedTeams));
            if (savedBets) setBets(JSON.parse(savedBets));
        }, []);

        useEffect(() => { localStorage.setItem('bettingTeams', JSON.stringify(teams)); }, [teams]);
        useEffect(() => { localStorage.setItem('bettingBets', JSON.stringify(bets)); }, [bets]);

        const handleSubmit = () => {
            if (!formData.teamA || !formData.teamB || !formData.odds || !formData.result) {
                alert('Please fill in all required fields'); return;
            }
            if (formData.teamA === formData.teamB) { alert('Team A and Team B must be different'); return; }
            const newBet = { id: Date.now(), teamA: formData.teamA, teamB: formData.teamB, goalLine: formData.goalLine,
                timeFrame: formData.timeFrame, bettingScore: formData.bettingScore, odds: parseFloat(formData.odds),
                result: formData.result, actualGoals: parseFloat(formData.actualGoals) || 0, actualScore: formData.actualScore, date: formData.date };
            setBets([...bets, newBet]);
            setFormData({ teamA: '', teamB: '', goalLine: '2.75', timeFrame: 'fulltime', bettingScore: '', odds: '',
                result: '', actualGoals: '', actualScore: '', date: new Date().toISOString().split('T')[0] });
            setShowAddForm(false);
        };

        const normalizePair = (teamA, teamB) => [teamA, teamB].sort().join(' vs ');

        const getTeamPairs = () => {
            const pairMap = new Map();
            bets.forEach(bet => {
                const pair = normalizePair(bet.teamA, bet.teamB);
                if (!pairMap.has(pair)) {
                    const parts = pair.split(' vs ');
                    pairMap.set(pair, { teamA: parts[0], teamB: parts[1], wins: 0, losses: 0 });
                }
                const pairData = pairMap.get(pair);
                if (bet.result === 'win') pairData.wins++;
                if (bet.result === 'halfwin') pairData.wins += 0.5;
                if (bet.result === 'halfloss') pairData.losses += 0.5;
                if (bet.result === 'lose') pairData.losses++;
            });
            return Array.from(pairMap.values());
        };

        const filteredPairs = getTeamPairs().filter(pair => {
            const s = searchTerm.toLowerCase();
            return pair.teamA.toLowerCase().includes(s) || pair.teamB.toLowerCase().includes(s);
        });

        const getSelectedPairBets = () => {
            if (!selectedPair) return [];
            return bets.filter(bet => normalizePair(bet.teamA, bet.teamB) === selectedPair);
        };

        const addTeam = () => {
            if (newTeamName.trim() && !teams.includes(newTeamName.trim())) {
                setTeams([...teams, newTeamName.trim()].sort()); setNewTeamName('');
            }
        };

        const deleteTeam = (t) => {
            if (window.confirm('Delete ' + t + '?')) setTeams(teams.filter(x => x !== t));
        };

        const exportData = () => {
            const data = { teams, bets, exportDate: new Date().toISOString() };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'betting-data-' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
            URL.revokeObjectURL(url);
        };

        const importData = (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (ev) => {
                try {
                    const data = JSON.parse(ev.target.result);
                    if (data.teams && data.bets && window.confirm('Replace all data?')) {
                        setTeams(data.teams); setBets(data.bets); alert('Imported!');
                    }
                } catch { alert('Error reading file'); }
            };
            reader.readAsText(file);
            e.target.value = '';
        };

        const deleteBet = (id) => { if (window.confirm('Delete bet?')) setBets(bets.filter(b => b.id !== id)); };
        const startEditBet = (bet) => setEditingBet({...bet});
        const saveEditBet = () => { setBets(bets.map(b => b.id === editingBet.id ? editingBet : b)); setEditingBet(null); };
        const cancelEditBet = () => setEditingBet(null);
        const getAllBetsSorted = () => [...bets].sort((a, b) => b.id - a.id);
        const getPaginatedBets = () => {
            const sorted = getAllBetsSorted();
            const start = (currentPage - 1) * betsPerPage;
            return sorted.slice(start, start + betsPerPage);
        };
        const totalPages = Math.ceil(bets.length / betsPerPage);

        return (
            <div className="max-w-7xl mx-auto p-6 bg-gray-50 min-h-screen">
                <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                    <div className="flex justify-between items-center mb-6 flex-wrap gap-3">
                        <h1 className="text-3xl font-bold text-gray-800">Team Pair Stats</h1>
                        <div className="flex gap-3 flex-wrap">
                            <button onClick={exportData} className="bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700">Export</button>
                            <label className="bg-purple-600 text-white px-4 py-3 rounded-lg hover:bg-purple-700 cursor-pointer">
                                Import <input type="file" accept=".json" onChange={importData} className="hidden" />
                            </label>
                            <button onClick={() => setShowEditTeams(!showEditTeams)} className="bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700">Edit Teams</button>
                            <button onClick={() => setShowAddForm(!showAddForm)} className="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700">Add Bet</button>
                            <button onClick={() => setShowAllBets(!showAllBets)} className="bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700">All Bets</button>
                        </div>
                    </div>

                    {showEditTeams && (
                        <div className="bg-gray-50 p-6 rounded-lg mb-6 border-2">
                            <h3 className="text-xl font-semibold mb-4">Manage Teams</h3>
                            <div className="flex gap-2 mb-4">
                                <input type="text" value={newTeamName} onChange={(e) => setNewTeamName(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && addTeam()} placeholder="Add team..." className="flex-1 p-3 border rounded" />
                                <button onClick={addTeam} className="bg-green-600 text-white px-6 py-3 rounded hover:bg-green-700">Add</button>
                            </div>
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-2">
                                {teams.map(t => (
                                    <div key={t} className="flex items-center justify-between bg-white p-2 rounded border">
                                        <span className="text-sm">{t}</span>
                                        <button onClick={() => deleteTeam(t)} className="text-red-600 hover:text-red-800 text-xs">Del</button>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {showAddForm && (
                        <div className="bg-gray-50 p-6 rounded-lg mb-6 border-2 border-blue-200">
                            <h3 className="text-xl font-semibold mb-4">Add New Bet</h3>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label className="block text-sm font-medium mb-1">Team A</label>
                                    <select value={formData.teamA} onChange={(e) => setFormData({...formData, teamA: e.target.value})} className="w-full p-3 border rounded">
                                        <option value="">Select Team A</option>
                                        {teams.map(t => <option key={t} value={t}>{t}</option>)}
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium mb-1">Team B</label>
                                    <select value={formData.teamB} onChange={(e) => setFormData({...formData, teamB: e.target.value})} className="w-full p-3 border rounded">
                                        <option value="">Select Team B</option>
                                        {teams.map(t => <option key={t} value={t}>{t}</option>)}
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium mb-1">Goal Line (Over)</label>
                                    <input type="text" value={formData.goalLine} onChange={(e) => setFormData({...formData, goalLine: e.target.value})}
                                        className="w-full p-3 border rounded" placeholder="2.75" />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium mb-1">Time</label>
                                    <select value={formData.timeFrame} onChange={(e) => setFormData({...formData, timeFrame: e.target.value})} className="w-full p-3 border rounded">
                                        <option value="fulltime">Full Time</option>
                                        <option value="firsthalf">First Half</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium mb-1">Betting At Score</label>
                                    <input type="text" value={formData.bettingScore} onChange={(e) => setFormData({...formData, bettingScore: e.target.value})}
                                        className="w-full p-3 border rounded" placeholder="0-0, 1-0" />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium mb-1">Odds</label>
                                    <input type="number" step="0.01" value={formData.odds} onChange={(e) => setFormData({...formData, odds: e.target.value})}
                                        className="w-full p-3 border rounded" placeholder="1.85" />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium mb-1">Result</label>
                                    <select value={formData.result} onChange={(e) => setFormData({...formData, result: e.target.value})} className="w-full p-3 border rounded">
                                        <option value="">Select Result</option>
                                        <option value="win">Won</option>
                                        <option value="halfwin">Half Won</option>
                                        <option value="draw">Draw</option>
                                        <option value="halfloss">Half Loss</option>
                                        <option value="lose">Loss</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium mb-1">Actual Goals</label>
                                    <input type="number" step="0.5" value={formData.actualGoals} onChange={(e) => setFormData({...formData, actualGoals: e.target.value})}
                                        className="w-full p-3 border rounded" placeholder="3" />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium mb-1">Final Score</label>
                                    <input type="text" value={formData.actualScore} onChange={(e) => setFormData({...formData, actualScore: e.target.value})}
                                        className="w-full p-3 border rounded" placeholder="2-1" />
                                </div>
                                <div className="md:col-span-3">
                                    <button onClick={handleSubmit} className="bg-green-600 text-white px-8 py-3 rounded hover:bg-green-700 text-lg font-semibold">Save Bet</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showAllBets ? (
                        <div className="bg-gray-50 p-6 rounded-lg border-2 border-indigo-200">
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="text-2xl font-bold">All Bets (Latest First)</h2>
                                <button onClick={() => setShowAllBets(false)} className="text-gray-600 hover:text-gray-800 text-2xl">×</button>
                            </div>
                            <div className="overflow-x-auto">
                                <table className="w-full border-collapse border-2">
                                    <thead className="bg-gray-200">
                                        <tr>
                                            <th className="border p-2 text-left text-xs">Date</th>
                                            <th className="border p-2 text-left text-xs">Match</th>
                                            <th className="border p-2 text-left text-xs">Bet At</th>
                                            <th className="border p-2 text-left text-xs">Over</th>
                                            <th className="border p-2 text-left text-xs">Time</th>
                                            <th className="border p-2 text-left text-xs">Odds</th>
                                            <th className="border p-2 text-left text-xs">Result</th>
                                            <th className="border p-2 text-left text-xs">Goals</th>
                                            <th className="border p-2 text-left text-xs">Score</th>
                                            <th className="border p-2 text-left text-xs">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {getPaginatedBets().map(bet => editingBet && editingBet.id === bet.id ? (
                                            <tr key={bet.id} className="bg-yellow-50">
                                                <td className="border p-1"><input type="date" value={editingBet.date} onChange={(e) => setEditingBet({...editingBet, date: e.target.value})} className="w-full p-1 border rounded text-xs" /></td>
                                                <td className="border p-1">
                                                    <select value={editingBet.teamA} onChange={(e) => setEditingBet({...editingBet, teamA: e.target.value})} className="w-full p-1 border rounded text-xs mb-1">
                                                        {teams.map(t => <option key={t} value={t}>{t}</option>)}
                                                    </select>
                                                    <select value={editingBet.teamB} onChange={(e) => setEditingBet({...editingBet, teamB: e.target.value})} className="w-full p-1 border rounded text-xs">
                                                        {teams.map(t => <option key={t} value={t}>{t}</option>)}
                                                    </select>
                                                </td>
                                                <td className="border p-1"><input type="text" value={editingBet.bettingScore || ''} onChange={(e) => setEditingBet({...editingBet, bettingScore: e.target.value})} className="w-16 p-1 border rounded text-xs" /></td>
                                                <td className="border p-1"><input type="text" value={editingBet.goalLine} onChange={(e) => setEditingBet({...editingBet, goalLine: e.target.value})} className="w-12 p-1 border rounded text-xs" /></td>
                                                <td className="border p-1">
                                                    <select value={editingBet.timeFrame} onChange={(e) => setEditingBet({...editingBet, timeFrame: e.target.value})} className="w-full p-1 border rounded text-xs">
                                                        <option value="fulltime">FT</option>
                                                        <option value="firsthalf">HT</option>
                                                    </select>
                                                </td>
                                                <td className="border p-1"><input type="number" step="0.01" value={editingBet.odds} onChange={(e) => setEditingBet({...editingBet, odds: e.target.value})} className="w-16 p-1 border rounded text-xs" /></td>
                                                <td className="border p-1">
                                                    <select value={editingBet.result} onChange={(e) => setEditingBet({...editingBet, result: e.target.value})} className="w-full p-1 border rounded text-xs">
                                                        <option value="win">Won</option>
                                                        <option value="halfwin">Half Won</option>
                                                        <option value="draw">Draw</option>
                                                        <option value="halfloss">Half Loss</option>
                                                        <option value="lose">Loss</option>
                                                    </select>
                                                </td>
                                                <td className="border p-1"><input type="number" step="0.5" value={editingBet.actualGoals || ''} onChange={(e) => setEditingBet({...editingBet, actualGoals: e.target.value})} className="w-12 p-1 border rounded text-xs" /></td>
                                                <td className="border p-1"><input type="text" value={editingBet.actualScore || ''} onChange={(e) => setEditingBet({...editingBet, actualScore: e.target.value})} className="w-16 p-1 border rounded text-xs" /></td>
                                                <td className="border p-1">
                                                    <button onClick={saveEditBet} className="bg-green-600 text-white px-2 py-1 rounded text-xs mr-1">Save</button>
                                                    <button onClick={cancelEditBet} className="bg-gray-600 text-white px-2 py-1 rounded text-xs">Cancel</button>
                                                </td>
                                            </tr>
                                        ) : (
                                            <tr key={bet.id} className="hover:bg-gray-50">
                                                <td className="border p-2 text-xs">{bet.date}</td>
                                                <td className="border p-2 text-xs">{bet.teamA} vs {bet.teamB}</td>
                                                <td className="border p-2 text-xs font-semibold text-blue-700">{bet.bettingScore || '-'}</td>
                                                <td className="border p-2 text-xs font-bold">{bet.goalLine}</td>
                                                <td className="border p-2 text-xs">{bet.timeFrame === 'fulltime' ? 'FT' : 'HT'}</td>
                                                <td className="border p-2 text-xs font-semibold">{bet.odds}</td>
                                                <td className="border p-2 text-xs">
                                                    <span className={'px-2 py-1 rounded font-bold text-xs ' + (bet.result === 'win' ? 'bg-green-200 text-green-900' : bet.result === 'halfwin' ? 'bg-green-100 text-green-800' : bet.result === 'draw' ? 'bg-gray-200' : bet.result === 'halfloss' ? 'bg-red-100 text-red-800' : 'bg-red-200 text-red-900')}>
                                                        {bet.result === 'win' ? 'WON' : bet.result === 'halfwin' ? 'HALF' : bet.result === 'draw' ? 'DRAW' : bet.result === 'halfloss' ? 'HALF L' : 'LOSS'}
                                                    </span>
                                                </td>
                                                <td className="border p-2 text-xs font-semibold">{bet.actualGoals || '-'}</td>
                                                <td className="border p-2 text-xs">{bet.actualScore || '-'}</td>
                                                <td className="border p-2">
                                                    <button onClick={() => startEditBet(bet)} className="bg-blue-600 text-white px-2 py-1 rounded text-xs mr-1">Edit</button>
                                                    <button onClick={() => deleteBet(bet.id)} className="bg-red-600 text-white px-2 py-1 rounded text-xs">Del</button>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                            {totalPages > 1 && (
                                <div className="flex justify-center items-center gap-2 mt-4">
                                    <button onClick={() => setCurrentPage(Math.max(1, currentPage - 1))} disabled={currentPage === 1}
                                        className="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 disabled:bg-gray-300">Previous</button>
                                    <span className="px-4 py-2">Page {currentPage} of {totalPages}</span>
                                    <button onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))} disabled={currentPage === totalPages}
                                        className="px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 disabled:bg-gray-300">Next</button>
                                </div>
                            )}
                        </div>
                    ) : (
                        <div>
                            <div className="mb-6">
                                <input type="text" placeholder="Search team..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)}
                                    className="w-full p-4 text-xl border-2 rounded-lg focus:border-blue-500 focus:outline-none" />
                            </div>
                            {filteredPairs.length === 0 ? (
                                <div className="text-center py-12 text-gray-500 text-xl">{bets.length === 0 ? 'No bets yet!' : 'No teams found'}</div>
                            ) : (
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                    {filteredPairs.map(pair => {
                                        const pk = pair.teamA + ' vs ' + pair.teamB;
                                        const sel = selectedPair === pk;
                                        return (
                                            <div key={pk} onClick={() => setSelectedPair(sel ? '' : pk)}
                                                className={'p-6 rounded-lg cursor-pointer border-2 ' + (sel ? 'border-blue-500 bg-blue-50 shadow-lg' : 'border-gray-200 bg-white hover:shadow-md')}>
                                                <h3 className="text-xl font-bold mb-4">{pk}</h3>
                                                <div className="flex justify-around items-center">
                                                    <div className="text-center">
                                                        <div className="text-4xl font-bold text-green-600">{pair.wins}</div>
                                                        <div className="text-sm text-gray-600 mt-1">Wins</div>
                                                    </div>
                                                    <div className="text-4xl text-gray-300">-</div>
                                                    <div className="text-center">
                                                        <div className="text-4xl font-bold text-red-600">{pair.losses}</div>
                                                        <div className="text-sm text-gray-600 mt-1">Losses</div>
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            )}
                            {selectedPair && (
                                <div className="mt-8">
                                    <h2 className="text-2xl font-bold mb-4">{selectedPair} - History</h2>
                                    <div className="overflow-x-auto">
                                        <table className="w-full border-2">
                                            <thead className="bg-gray-200">
                                                <tr>
                                                    <th className="border p-3 text-left">Date</th>
                                                    <th className="border p-3 text-left">Bet At</th>
                                                    <th className="border p-3 text-left">Over</th>
                                                    <th className="border p-3 text-left">Time</th>
                                                    <th className="border p-3 text-left">Odds</th>
                                                    <th className="border p-3 text-left">Result</th>
                                                    <th className="border p-3 text-left">Goals</th>
                                                    <th className="border p-3 text-left">Score</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {getSelectedPairBets().map(bet => (
                                                    <tr key={bet.id} className="hover:bg-gray-50">
                                                        <td className="border p-3">{bet.date}</td>
                                                        <td className="border p-3 font-semibold text-blue-700">{bet.bettingScore || '-'}</td>
                                                        <td className="border p-3 font-bold text-lg">{bet.goalLine}</td>
                                                        <td className="border p-3">{bet.timeFrame === 'fulltime' ? 'FT' : 'HT'}</td>
                                                        <td className="border p-3 font-semibold">{bet.odds}</td>
                                                        <td className="border p-3">
                                                            <span className={'px-3 py-1 rounded font-bold ' + (bet.result === 'win' ? 'bg-green-200 text-green-900' : bet.result === 'halfwin' ? 'bg-green-100 text-green-800' : bet.result === 'draw' ? 'bg-gray-200' : bet.result === 'halfloss' ? 'bg-red-100 text-red-800' : 'bg-red-200 text-red-900')}>
                                                                {bet.result === 'win' ? 'WON' : bet.result === 'halfwin' ? 'HALF WON' : bet.result === 'draw' ? 'DRAW' : bet.result === 'halfloss' ? 'HALF LOSS' : 'LOSS'}
                                                            </span>
                                                        </td>
                                                        <td className="border p-3 font-semibold">{bet.actualGoals || '-'}</td>
                                                        <td className="border p-3">{bet.actualScore || '-'}</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            </div>
        );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
</script>
</body>
</html>